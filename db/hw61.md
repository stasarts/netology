# Домашнее задание к занятию "6.1. Типы и структура СУБД"

---

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

### Ответ

```
Электронные чеки в json виде
```
Документоориентированная NoSQL. Каждый чек - документ.

```
Склады и автомобильные дороги для логистической компании
```
Графовая NoSQL. Может помочь одновременно решать задачу кратчайшего пути.

```
Генеалогические деревья
```
Иерархическая NoSQL. Само по себе генеалогическое дерево - это иерархическая модель.

```
Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
```
Ключ-значение NoSQL. Быстрый и малозатратный доступ.

```
Отношения клиент-покупка для интернет-магазина
```
В самом вопросе заложен ответ - реляционная БД. (relation - отношение)

---

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

### Ответ

```
Данные записываются на все узлы с задержкой до часа (асинхронная запись)
```
CAP: AP, т.к. асинхронная запись не дает консистентности (как минимум в часовой интервал по условию).
PACELC: PA/EL, т.к. если система разделена и недоступна, то система скорее всего синхронизируется и стоит побороться за время ответа.

```
При сетевых сбоях, система может разделиться на 2 раздельных кластера
```
CAP: AP, т.к. разделенная система не может быть консистентной.
PACELC: PA/EL, т.к. нет понимания как долго узлы будут разделенными, лучше сделать упор на доступность.

```
Система может не прислать корректный ответ или сбросить соединение
```
CAP: CP, т.к. нарушается доступность, не гарантируется корректный отклик.
PACELC: PC/EC, т.к. судя по всему доступность приносится в жертву и преобладает консистентность.

---

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

### Ответ

Принципы BASE и ACID ***не могут*** сочетаться в одной системе.  
Потому что по ACID - данные всегда согласованные (и ответ всегда верный), а по BASE - согласованные, но с течением времени. Т.о. в некоторый момент времени могут быть неверные.

---

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

### Ответ

Это хранилище с СУБД Redis - резидентная система управления базами данных класса NoSQL с открытым исходным кодом, работающая со структурами данных типа «ключ — значение». Используется как для баз данных, так и для реализации кэшей, брокеров сообщений.  
Минусы:  
* хранит базу данных в оперативной памяти, данные потеряются при отказе сервера или перезапуске сервиса
* снабжена механизмами снимков и журналирования для обеспечения постоянного хранения (на дисках, твердотельных накопителях), но тогда теряется скорость работы
* для корректной работы требуется обеспечить достаточное количество оперативной памяти

---
